# Chapter 20 Readable Passwords (읽을 수 있는 비밀번호)

## 목표 - 비밀번호를 복구하거나 재설정하기
어떤 어플리케이션이든 비밀번호가 있고 유저들은 자신의 비밀번호를 잊어버리는 것은 불변의 진리이다. 대부분의 어플리케이션에서는 비밀번호 복구나 재설정하는 이메일을 발송하여 이런 문제를 해결한다. 이 방법은 유저 프로필에 이메일이 등록되어있는 경우 사용할 수 있다.

## 안티패턴 - 비밀번호를 평문으로 저장하기
비밀번호 복구 기능에서 자주 발생하는 실수는 유저에게 발송되는 이메일에 해당 유저의 비밀번호를 작성하여 보내는 경우이다. 이는 데이터베이스 설계에 아주 심각한 결함이 있는 증거이며 이를 통해 인증되지 않은 사용자가 권한을 획득해 해당 어플리케이션에 접근 가능하게끔 하는 치명적인 보안 이슈를 야기시킨다.

이번 섹션에서는 비밀번호를 평문으로 저장했을시, 어떤 문제가 발생하는지 예제를 통해 살펴보고자 한다.

### 비밀번호 저장
비밀번호는 보통 `Accounts` 테이블 내 문자열 속성의 컬럼으로 저장된다.
```sql
CREATE TABLE Accounts (
  account_id SERIAL PRIMARY KEY,
  account_name VARCHAR(20) NOT NULL,
  email VARCHAR(100) NOT NULL,
  password VARCHAR(30) NOT NULL
);
```

계정을 생성할때 단순히 문자열 리터럴 형식으로 비밀번호를 추가하여 생성할 수 있다.
```sql
INSERT INTO Accounts (account_id, account_name, email, password)
  VALUES (123, 'billkarwin', 'bill@example.com', 'xyzzy');
```
이렇게 비밀번호를 평문으로 저장하는것은 보안상 위험할 뿐만 아니라 네트워크 상에서도 그대로 드러나게 된다. 공격자가 비밀번호를 추가하는 SQL 선언문을 읽을수 있다면 비밀번호 또한 그대로 드러나게 된다. 이는 비밀번호 변경이나 로그인 시 비밀번호 검증시에도 동일한 위험을 가지고 있다. 해커들은 다양한 방법으로 사용자의 비밀번호를 탈취 할 수 있게 된다.
* 어플리케이션에서 클라이언트로 전송되는 SQL 선언문이 포함된 네트워크 패킷을 탈취 할 수 있다. 이 방법은 생각보다 훨씬 쉽다. 게다가 이를 손쉽게 수행 할 수 있는 [Wireshark](https://www.wireshark.org/)와 같은 무료 소프트웨어도 존재한다.
* 데이터베이스 서버에서 SQL로그를 검색 할 수 있다. 공격자는 데이터베이스 서버 호스트에 접근을 해야하지만 접근이 가능하다면 그들은 해당 호스트에서 SQL 선언문이 담긴 로그파일을 찾을 수 있을 것이다.
* 데이터베이스 백업파일을 탈취할 수도 있다. 백업 솔루션이 안전한지는 아무도 확신 할 수 없다.

### 비밀번호 인가

## 어떻게 안티패턴을 구분하는가

## 안티패턴 사용이 정당화 되는 경우

## 해결책 - 솔트 처리된 해시로 비밀번호 저장하기


> 이 글은 [SQL Antipatterns - by Bill Karwin](https://pragprog.com/titles/bksqla/sql-antipatterns/) 영문 원본의 Chapter20 를 요약한 글입니다. 자의적인 해석이 들어 간 것을 참고하셨으면 좋겠습니다.
